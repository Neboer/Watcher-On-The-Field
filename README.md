# Watcher On The Field

minecraft 麦田里的守望者：自动小麦收割机器人

## 功能
本程序是minecraft的一个机器人，基于[mineflayer](https://github.com/PrismarineJS/mineflayer)库开发。目前拥有如下功能：

- 收割已经成熟的小麦
- 捡起溅落的物品
- 将足够的小麦合成干草块
- 在空的耕地上种植小麦

## 稳定性
诚实的讲，程序可以用，但是并不十分稳定，不建议直接在生存模式服务器中长时间挂机使用，因为可能会产生各种问题。但是欢迎各位做出尝试。

mineflayer和minecraft通信的过程并不十分完美，经常会有回调函数无法执行到的问题，也就是服务器没有确认返回，就会让客户端陷入等待中。
为了解决这个问题，我重新构造了一套支持重复执行的函数，并增加了可以设定的超时阈值功能。这些都在一定程度上保证了程序在运行的时候的稳定性。
目前机器人可能出现的问题只有以下几种：
- 机器人可能会陷入死循环，即反复重复一种特定的动作而不发现其他的任务。因为它坚持要完成某件任务，但是那件任务对他来说是不可能完成的。
- 机器人与工作台的互动经常失败。这个问题可能是mineflayer的固有问题。
- 机器人的地图和真实的游戏地图并不完全相同，因为可能有一些世界更新的数据包被mineflayer底层的minecraft protocol忽略掉，从而导致机器人可能就是会忽略特定地块上的小麦是否成熟/耕地是否播种。

但是以上的问题在数小时的测试中发生次数极为罕见，程序本身无法保证绝对的稳定性，还是需要底层更加稳定的支持。

## 开发以及开发问题
程序依赖于mineflayer的[pathfinder](https://github.com/Karang/mineflayer-pathfinder)模块自动寻路。
但是，这个模块更多面向真实应用场景，所以有些功能非常多余，比如移除前进路上的方块——包括未成熟的小麦种子，很离谱。并且这个寻路也会更改机器人手中拿着的物品。程序目前的解决方案是hook掉dig/place之类的方法，但这必然不是长久之计。
未来，程序将会拥有自己的寻路系统。

之前的版本里，机器人是可以正常与工作台互动的，但是这版中机器人与工作台互动会产生服务端拒绝的错误，目前还不清楚原因。
独立开发精力有限，虽然很好玩但是毕竟不能真正的解决所有的问题，实在是非常遗憾。

## 欢迎加入协作
如果你对mc机器人感兴趣，不妨从这个项目开始练练手，最终让这个bot变得更加完善是我们的目的。未来我打算在依赖库稳定之后，制作更多的mc机器人，给玩家带来更多的乐趣。

同时js是很适合写mc机器人的一个语言，它的事件系统十分强大，当然要感谢nodejs，同时也感谢mineflayer的全体开发团队，虽然库不能尽善尽美，但是最终呈现效果已经非常令人满意了。